# 背景

プログラマー向けの言語学習を、CLIで効率的に行いたいという背景がある。単語帳・例文集をGitで管理し、個人の学習データを履歴管理できるようにしたい意図がある。

# ゴール

- 単語とその意味の登録を基本操作とするCLIツールを提供すること。
- 単語帳・例文集をGitで管理できるようにすること。
- 辞書ごとに単語帳・例文を管理できること。
- 任意の辞書名で辞書を作成し、切り替えできること。
- 綴りが一致しても辞書が異なる単語を混同しないこと。
- AIと連携して例文を作成できること（初期はOpenAIのみ対応でよいが、将来的にローカルLLMも許容する）。
- 単語・例文のチェックをローカルで実行できること（オフラインでも完結する）。
- 単一バイナリとして配布できること。
- 登録済みの単語・例文を使ったテスト（記憶チェック）をCLIで実行できること。
- 登録済みの単語・例文を使ったテスト（記憶チェック）をCLIで実行できること。

# 非ゴール

- SRS/復習アルゴリズムは対象外である。
- GUI/モバイル対応は対象外である。
- クラウド同期・アカウント機能は対象外である。

# 想定ユーザー

- GitとCLIに慣れているプログラマーである。
- 自分の学習データをリポジトリとして管理したい個人学習者である。

# 利用シナリオ

- ユーザーがリポジトリ内で単語と意味を登録し、データをGitで管理する。
- ユーザーが辞書を選択して単語帳・例文を管理する。
- ユーザーがAI連携で例文を生成し、結果を確認する。
- オフライン環境で単語・例文のチェックを実行する。
- ユーザーが意味テストを起動し、単語→意味の順で回答し、記憶状況を記録する。
- ユーザーが例文テストを起動し、単語→例文の順で回答し、記憶状況を記録する。
- ユーザーが意味テストを起動し、単語→意味の順で回答し、記憶状況を記録する。
- ユーザーが例文テストを起動し、単語→例文の順で回答し、記憶状況を記録する。

# 制約

- 対象OSはWindows、macOS、Linuxである。
- 語彙データ形式はJSONである。
- 辞書は辞書名を持つオブジェクトで表現する。
- 単語帳・例文のチェックはローカルで完結し、オフラインに対応する。
- AI連携はcodex, claude-codeなど、CLI形式で行う。
- 配布形態は単一バイナリである。
- 既存単語に対して意味を追記でき、競合はエラーとしない。
- エラー分類は入力不正、参照不能、ファイルI/O、AI連携失敗とする。
- 現在選択中の辞書は常に表示する。
- 破壊的操作では辞書指定を必須とする。
- 用語は「辞書」で統一する。
- テストはインタラクティブに実行できること。
- テストは一定回数の出題を繰り返すこと（デフォルト10回、回数指定を許容する）。
- テストのスコアは語彙データに埋め込むこと。
- 出題はスコアに反比例した重み付きランダムであり、将来的にアルゴリズムを交換可能にする。
- 例文テストで例文がない単語が選ばれた場合はスキップして再抽選する。
- 例文テストでは同じ単語が複数回選択されてもよい。
- 例文テストで同じ例文が選択された場合はスキップする。
- 指定回数未満の出題で終了してもよい。
- 意味テストでは同じ単語が複数回選択されてはならない。
- 単語数または例文数が指定回数に満たない場合は、テストを途中で終了してもよい（エラーではなく通常終了）。
- テストはインタラクティブに実行できること。
- テストは一定回数の出題を繰り返すこと（デフォルト10回、回数指定を許容する）。

# 未決事項（Decision needed）

- CLIの具体的なコマンド体系と入出力仕様をどうするか。
- JSONの具体的なスキーマ（単語・意味・例文・辞書の格納形式）をどう定義するか。
- AI生成物（例文）の保存方針と更新ルールをどうするか。
- テストのスコアをどこに保存するか（語彙データへの埋め込みか、別ファイルか）。
- テストの出題ロジック（スコアの重み付け、同点時の扱い）をどうするか。
- 例文テストで例文が無い単語をどう扱うか。
